  {#
/**
 * @file
 * Block template for Footer (block_content--blocco-footer)
 *
 * Displays a dynamic footer with block fields and footer menu.
 *
 * Available fields:
 * - field_titolo: Footer title
 * - body: Footer description text
 * - field_open_badge_logo: Footer logo image
 * - field_email_footer: Contact email
 * - field_privacy_policy: Privacy policy link
 * - field_date_obv: Date/copyright text
 *
 * Menu: menu-footer (rendered via drupal_menu)
 */
#}

{# ========================================
   1. EXTRACT FIELD VALUES
   ======================================== #}
{# Extract field values using content variable #}
{% set title = content.field_titolo.0 %}
{% set body = content.body.0 %}
{% set email = content.field_email_footer.0 %}
{% set date_obv = content.field_date_obv.0 %}

{# Logo #}
{% set logo_url = '' %}
{% if content.field_open_badge_logo['#items'] is not empty %}
  {% set logo_url = file_url(content.field_open_badge_logo['#items'].entity.fileuri) %}
{% endif %}

{# Privacy Policy link #}
{% set privacy_url = '' %}
{% set privacy_label = '' %}
{% if content.field_privacy_policy['#items'] is not empty %}
  {% set privacy_url = content.field_privacy_policy['#items'].0.url.toString() %}
  {% set privacy_label = content.field_privacy_policy['#items'].0.title|default('Privacy Policy') %}
{% endif %}

{# Edit URL for admins #}
{% set edit_url = path('entity.block_content.edit_form', {'block_content': elements['#block_content'].id()}) %}

{# ========================================
   2. FOOTER SECTION
   ======================================== #}
<footer class="bg-slate-950 text-slate-300 py-12 text-sm">
  <div class="max-w-6xl mx-auto px-4 sm:px-6">

    {# Top Row: Menu Sections + Logo in corner #}
    <div class="flex flex-col md:flex-row md:justify-between gap-8 pb-8">

      {# Left: Footer Menu Sections #}
      <div class="flex flex-col sm:flex-row gap-8">
        {{ drupal_menu('menu-footer') }}
      </div>

      {# Right Corner: Logo & Description #}
      <div class="space-y-4 md:text-right flex-shrink-0">
        {% if logo_url %}
          <img src="{{ logo_url }}" alt="{{ title }}" class="h-10 w-auto md:ml-auto" />
        {% endif %}
        {% if title %}
          <p class="text-xs uppercase tracking-widest text-slate-500">{{ title }}</p>
        {% endif %}
        {% if body %}
          <p class="text-xs text-slate-400 leading-relaxed max-w-[200px] md:ml-auto">{{ body }}</p>
        {% endif %}
        {% if email %}
          <a href="mailto:{{ email }}" class="text-xs text-slate-400 hover:text-white transition-colors">
            {{ email }}
          </a>
        {% endif %}
      </div>

    </div>

    {# Bottom Row: Copyright & Privacy #}
    <div class="border-t border-slate-800 pt-6 flex flex-col md:flex-row md:items-center gap-4 text-[11px] text-slate-500">
      {% if date_obv %}
        <p>{{ date_obv }}</p>
      {% else %}
        <p>&copy; <span id="year"></span> Open Badge EU. Tutti i diritti riservati.</p>
      {% endif %}

      <div class="flex flex-wrap gap-4">
        {% if privacy_url %}
          <a href="{{ privacy_url }}" class="hover:text-white transition-colors">{{ privacy_label }}</a>
        {% endif %}
      </div>
    </div>

    {# Edit button for admins #}
    {% if user.hasPermission('administer blocks') %}
      <div class="mt-4 text-right">
        <a href="{{ edit_url }}" class="inline-flex items-center gap-2 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs font-medium rounded transition-colors">
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
          </svg>
          Edit Footer
        </a>
      </div>
    {% endif %}

  </div>
</footer>